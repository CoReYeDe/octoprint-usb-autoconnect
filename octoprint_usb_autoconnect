#!/bin/bash
CONFIGFILE="/usr/local/src/octoprint-usb-autoconnect/octoprint_usb_autoconnect.conf"

if [ ! -f ${CONFIGFILE} ]; then
    echo "Configuration file \"${CONFIGFILE}\""
    exit 1
fi

# Load API key from config file
. ${CONFIGFILE}

# Send POST request to reconnect serial connection
curl -siL -X POST -H "X-Api-Key: ${APIKEY}" -H "Content-Type: application/json" ${OCTOHOST}/api/connection -d '{"command":"connect"}'
